# Multi-Model RAG (LangGraph + Flask)

A simple, customizable RAG chat application with:
- LangGraph agent flow
- Retriever tool + reranking
- Threaded conversations
- Long-term memory (SQLite by default, PostgreSQL optional)
- ChatGPT-style web UI (Flask + HTML/CSS/JS)
- Multi-source ingestion (PDF, web URL, YouTube, audio)

## Features

- **LangGraph agent** with retriever tool execution
- **Semantic reranking** on retrieved candidates
- **Thread titles** generated by LLM
- **Conversation history** per thread
- **Rich frontend rendering** (markdown-like assistant output)
- **Upload + index pipeline** for docs/media

## Project Structure

```text
backend/
  app.py                # Original upload/query app
  app2.py               # LangGraph chat app (main)
services/
  chunking.py
  embedding.py
  faiss_db.py
  gen.py
  ingestion.py
  langgraph_agent.py
  retriever.py
templates/
  chat.html             # Sidebar chat UI
  uploader.html
  query.html
  results.html
utility/
requirements.txt
README.md
```

## Setup

### 1) Install dependencies

```bash
pip install -r requirements.txt
```

### 2) Configure environment

Create `.env` in project root:

```env
GROQ_API_KEY=your_groq_api_key

# Optional
GROQ_MODEL=qwen/qwen3-32b
GROQ_TEMPERATURE=0
GROQ_MAX_TOKENS=2000
RAG_TOP_K=4

# Memory backend
LANGGRAPH_MEMORY_BACKEND=sqlite
# LANGGRAPH_MEMORY_BACKEND=postgres
# LANGGRAPH_POSTGRES_URI=postgresql://user:password@host:5432/dbname

# Optional tracing
LANGSMITH_API_KEY=your_langsmith_key
LANGCHAIN_PROJECT=rag-langgraph
```

## Run

### LangGraph chat app

```bash
python backend/app2.py
```

Open: `http://127.0.0.1:5001`

### Health check

```bash
curl http://127.0.0.1:5001/health
```

## API (app2)

- `GET /health`
- `POST /api/chat`
  - body: `{"message":"...","thread_id":"optional"}`
- `POST /api/threads`
- `GET /api/threads`
- `GET /api/threads/<thread_id>/messages`
- `POST /api/upload` (multipart form: files/url/url_type)

## GitHub Deployment Notes

Before pushing:
- Keep `.env` and runtime DB/index/log files out of git (handled by `.gitignore`)
- Push only source code and templates

## License

MIT
